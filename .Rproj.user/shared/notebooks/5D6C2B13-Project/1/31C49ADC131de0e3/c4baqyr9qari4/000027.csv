"0","library(shiny)"
"0","library(shinydashboard)"
"0","library(leaflet)"
"0","library(ggplot2)"
"0","library(dplyr)"
"0","library(sf)"
"0",""
"0","# Data preparation"
"0","data <- result %>%"
"0","  mutate("
"0","    Date = as.Date(JOUR),"
"0","    YearMonth = format(Date, ""%Y-%m"")"
"0","  )"
"0",""
"0","# Filter data based on IDs"
"0","filtered_new_data <- data %>%"
"0","  st_as_sf(coords = c(""ZdAXEpsg2154"", ""ZdAYEpsg2154""), crs = 2154) %>%"
"0","  st_transform(2154) %>%  # Transformation des coordonn√©es Lambert 93"
"0","  mutate("
"0","    X = st_coordinates(.)[, 1],  # X en Lambert 93"
"0","    Y = st_coordinates(.)[, 2]   # Y en Lambert 93"
"0","  )"
"0",""
"0","# UI"
"0","ui <- dashboardPage("
"0","  dashboardHeader(title = ""Ridership Dashboard""),"
"0","  dashboardSidebar("
"0","    sidebarMenu("
"0","      menuItem(""Overview"", tabName = ""overview"", icon = icon(""chart-line"")),"
"0","      menuItem(""Map"", tabName = ""map"", icon = icon(""map"")),"
"0","      menuItem(""Comparison"", tabName = ""comparison"", icon = icon(""exchange-alt""))"
"0","    )"
"0","  ),"
"0","  dashboardBody("
"0","    tabItems("
"0","      # Overview Tab"
"0","      tabItem(tabName = ""overview"","
"0","              fluidRow("
"0","                box(dateRangeInput(""date_range"", ""Select Date Range:"","
"0","                                   start = min(data$Date), end = max(data$Date)),"
"0","                    width = 4),"
"0","                box(plotOutput(""overall_trends""), width = 8)"
"0","              )),"
"0","      # Map Tab"
"0","      tabItem(tabName = ""map"","
"0","              fluidRow("
"0","                box(selectizeInput(""station"", ""Select Station:"","
"0","                                   choices = NULL, multiple = FALSE),"
"0","                    width = 4),"
"0","                box(leafletOutput(""station_map""), width = 8)"
"0","              )),"
"0","      # Comparison Tab"
"0","      tabItem(tabName = ""comparison"","
"0","              fluidRow("
"0","                box("
"0","                  selectInput(""ref_period"", ""Select Reference Period:"","
"0","                              choices = unique(data$YearMonth), multiple = FALSE),"
"0","                  selectInput(""comp_period"", ""Select Comparison Period:"","
"0","                              choices = unique(data$YearMonth), multiple = FALSE),"
"0","                  width = 4"
"0","                ),"
"0","                box(plotOutput(""comparison_plot""), width = 8)"
"0","              ))"
"0","    )"
"0","  )"
"0",")"
"0",""
"0","# Server"
"0","server <- function(input, output, session) {"
"0","  # Update selectizeInput for stations (server-side rendering)"
"0","  updateSelectizeInput(session, ""station"", choices = unique(data$LIBELLE_ARRET), server = TRUE)"
"0","  "
"0","  # Filtered data for trends"
"0","  filtered_data <- reactive({"
"0","    data %>%"
"0","      filter(Date >= input$date_range[1] & Date <= input$date_range[2])"
"0","  })"
"0","  "
"0","  # Plot overall trends"
"0","  output$overall_trends <- renderPlot({"
"0","    ggplot(filtered_data(), aes(x = Date, y = Total_NB_VALD)) +"
"0","      geom_line(color = ""blue"") +"
"0","      labs(title = ""Overall Ridership Trends"", x = ""Date"", y = ""Ridership"")"
"0","  })"
"0","  "
"0","  # Leaflet map for station locations"
"0","  output$station_map <- renderLeaflet({"
"0","    station_data <- filtered_new_data %>% filter(LIBELLE_ARRET == input$station)"
"0","    leaflet(station_data) %>%"
"0","      addTiles() %>%"
"0","      addCircleMarkers("
"0","        lng = ~X, lat = ~Y,"
"0","        label = ~LIBELLE_ARRET, "
"0","        popup = ~paste(""Station:"", LIBELLE_ARRET, ""<br>Ridership:"", Total_NB_VALD)"
"0","      )"
"0","  })"
"0","  "
"0","  # Comparison plot"
"0","  output$comparison_plot <- renderPlot({"
"0","    ref_data <- data %>% filter(YearMonth == input$ref_period)"
"0","    comp_data <- data %>% filter(YearMonth == input$comp_period)"
"0","    "
"0","    ggplot() +"
"0","      geom_line(data = ref_data, aes(x = Date, y = Total_NB_VALD), color = ""blue"", linetype = ""dashed"") +"
"0","      geom_line(data = comp_data, aes(x = Date, y = Total_NB_VALD), color = ""red"") +"
"0","      labs(title = ""Ridership Comparison"", x = ""Date"", y = ""Ridership"","
"0","           caption = ""Blue: Reference Period, Red: Comparison Period"") +"
"0","      theme_minimal()"
"0","  })"
"0","}"
"0",""
"0","# Run the Shiny app"
"0","shinyApp(ui = ui, server = server)"
"2","
Listening on http://127.0.0.1:6248
"
"2","  103: [37mexpandLimits[39m
"
"2",""
"2","  101: [37maddCircleMarkers[39m
"
"2",""
"2","  100: [37m%>%[39m
"
"2",""
"2","   99: [34m[1m::
htmlwidgets
shinyRenderWidget [#21][22m[39m
"
"2",""
"2","   98: [37mfunc[39m
"
"2",""
"2","   85: [37mrenderFunc[39m
"
"2",""
"2","   84: [37moutput$station_map[39m
"
"2",""
"2","    3: [37mrunApp[39m
"
"2",""
"2","    2: [37mprint.shiny.appobj[39m
"
"2",""
"2","    1: [37m<Anonymous>[39m
"
