"0","count_invalid_rows <- function(data) {"
"0","  # Vérifier les colonnes spécifiées"
"0","  cols_to_check <- c(""CODE_STIF_TRNS"", ""CODE_STIF_RES"", ""CODE_STIF_ARRET"", ""NB_VALD"")"
"0","  "
"0","  # Vérifier si les colonnes existent dans le dataframe"
"0","  if (!all(cols_to_check %in% colnames(data))) {"
"0","    stop(""Les colonnes spécifiées ne sont pas toutes présentes dans le dataframe."")"
"0","  }"
"0","  "
"0","  # Fonction pour détecter les caractères non numériques ou les espaces"
"0","  is_invalid <- function(column) {"
"0","    grepl(""[^0-9]"", column) | grepl(""\\s"", column) # Non numérique ou contient un espace"
"0","  }"
"0","  "
"0","  # Identifier les lignes contenant des valeurs invalides dans les colonnes spécifiées"
"0","  invalid_rows <- data %>%"
"0","    filter(if_any(all_of(cols_to_check), is_invalid))"
"0","  "
"0","  # Retourner le nombre de lignes invalides"
"0","  return(nrow(invalid_rows))"
"0","}"
"0",""
"0","# Exemple d'utilisation"
"0","count_invalid_rows(merged_data)"
"1","[1]"
"1"," 13162"
"1","
"
